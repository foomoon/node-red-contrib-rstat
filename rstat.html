<script type="text/x-red" data-template-name="rstat in">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-ip"><i class="fa fa-location-arrow"></i> IP Address</label>
        <input type="text" id="node-input-ip" placeholder="0.0.0.0">
        <a id="node-input-ip-lookup" class="btn"><i id="node-input-ip-lookup-icon" class="fa fa-search"></i></a>
    </div>
</script>

<script type="text/x-red" data-help-name="rstat in">
    <p>Rstat.</p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('rstat in', {
        category: 'weather',
        color: "#d8455d",
        defaults: {
            name: {
                value: ""
            },
            ip: {
                value: "",
                required: true
            }
        },
        inputs: 1,
        outputs: 1,
        icon: "rstat.png",
        label: function() {
            //var dbNode = RED.nodes.node(this.mydb);
            return this.name || "Radio Thermostat";
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {

            $("#node-input-ip-lookup").click(function() {

                $("#node-input-ip-lookup").addClass('disabled');

                var rtstat = require('rtstat');
                //var tlist = rtstat.findThermostats();
                var output = ['a', 'b', 'c'];
                /*tlist.then(function(thermostats) {
                    for (var key in thermostats) {
                        // 'key' is this thermostat's uuid
                        var thisTstat = thermostats[key];
                        output.push(thisTstat.ipAddress);
                    }
                    $("#node-input-ip-lookup").removeClass('disabled');
                    */
                //node-input-ip
                $("#node-input-ip").autocomplete({
                    source: output,
                    minLength: 0,
                    close: function(event, ui) {
                        $("#node-input-ip").autocomplete("destroy");
                    }
                }).autocomplete("search", "");

                //});





                /*
                $.getJSON('serialports', function(data) {
                    $("#node-config-lookup-serial").removeClass('disabled');
                    var ports = [];
                    $.each(data, function(i, port) {
                        ports.push(port.comName);
                    });
                    $("#node-config-input-serialport").autocomplete({
                        source: ports,
                        minLength: 0,
                        close: function(event, ui) {
                            $("#node-config-input-serialport").autocomplete("destroy");
                        }
                    }).autocomplete("search", "");
                });*/
            });

        }
    });
</script>